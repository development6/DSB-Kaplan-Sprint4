@{
    Layout = null;
}

<!--Kinesiologia-->

<!DOCTYPE html>

<html>
<head runat="server">
    <meta name="viewport" content="width=device-width" />
    <title>Nutrición</title>
    <style type="text/css">
        body {
            font-family: Arial;
            font-size: 10pt;
        }
    </style>

</head>
<body>

    <center>
        <h1>Dashboard</h1>
    </center>

    <h2>Nutrición</h2>

    Paciente:
    <select id="ddlPaciente">
        <option value="11">Andrés Soto Díaz</option>
        <option value="12">Gloria Sepúlveda Romero</option>
        <option value="13">Olga Hernández Rivera</option>

    </select>
    <table id="rblChartType" border="0">
        <tr>
            <td><input type="radio" name="ChartType" value="1" checked="checked" />Bar</td>
            <td><input type="radio" name="ChartType" value="2" />Radar</td>
        </tr>
    </table>
    <div id="dvChart" style="width:50%; position:relative;">
    </div>


    <!--<table border="0" cellpadding="0" cellspacing="0">

        <tr>
            <td>
                Paciente:
                <select id="ddlPaciente">
                    <option value="1">Paciente</option>

                </select>
                <table id="rblChartType" border="0">
                    <tr>
                        <td><input type="radio" name="ChartType" value="1" checked="checked" />Bar</td>
                        <td><input type="radio" name="ChartType" value="2" />Radar</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>
                <div id="dvChart">
                </div>
            </td>

        </tr>
        <tr></tr>
    </table>-->


    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/excanvas/r3/excanvas.js" type="text/javascript"></script>
    <script src="//cdn.jsdelivr.net/chart.js/0.2/Chart.js" type="text/javascript"></script>


    <script type="text/javascript">
        $(function () {
            LoadChart();
            $("#ddlPaciente").bind("change", function () {
                LoadChart();
            });
            $("#rblChartType input").bind("click", function () {
                LoadChart();
            });
        });
        function LoadChart() {
            var chartType = parseInt($("#rblChartType input:checked").val());
            var ingreso = [];
            var egreso = [];
            var datachart = {
                labels: ["KG MUSC", "KG Grasa", "%MG", "Nivel GV", "Indice", "P.Cintura", "Peso", "Talla", "IMC"],
                datasets: [
                    {
                        label: "Ingreso",
                        backgroundColor: "rgba(90,193,208,0.3)",
                        borderColor: "rgba(151,187,205,0.7)",
                        borderWidth: 1,
                        hoverBackgroundColor: "rgba(151,187,205,1)",
                        hoverBorderColor: "rgba(151,187,205,0.5)",
                        data: ingreso
                    },
                    {
                        label: "Egreso",
                        backgroundColor: "rgba(215,220,67,0.3)",
                        borderColor: "rgba(220,220,220,0.7)",
                        borderWidth: 1,
                        hoverBackgroundColor: "rgba(220,220,220,1)",
                        hoverBorderColor: "rgba(220,220,220,0.5)",
                        data: egreso
                    }
                ]
            };
            $.ajax({
                type: "POST",
                url: "/Home/AjaxMethod",
                data: "{Paciente: '" + $("#ddlPaciente").val() + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (response) {
                    $("#dvChart").html("");
                    //$("#dvLegend").html("");
                    //$("#dvTabla").html("");
                    var data = eval(response);
                    //var data = (eval("(" + response.d + ")"));
                    var el = document.createElement('canvas');
                    $("#dvChart")[0].appendChild(el);


                    //window.alert(data);
                    //Fix for IE 8
                    if ($.browser.msie && $.browser.version == "8.0") {
                        G_vmlCanvasManager.initElement(el);
                    }

                    for (var i = 0; i < data.length; i++) {
                        ingreso.push(data[i].value0, data[i].value1, data[i].value2, data[i].value3, data[i].value4, data[i].value5, data[i].value6, data[i].value7, data[i].value8);
                        egreso.push(data[i].value9, data[i].value10, data[i].value11, data[i].value12, data[i].value13, data[i].value14, data[i].value15, data[i].value16, data[i].value17);
                    }

                    //console.log(ingreso);
                    //window.alert(ingreso);

                    var ctx = el.getContext('2d');
                    var userStrengthsChart;

                    switch (chartType) {
                        case 1:
                            userStrengthsChart = new Chart(ctx, {
                                type: 'bar',
                                data: datachart,
                                options: {
                                    title: {
                                        display: true,
                                        text: "Ergometría"
                                    },
                                    annotation: {
                                        annotations: [
                                            {
                                                type: 'line',
                                                mode: 'horizontal',
                                                scaleID: 'y-axis-0',
                                                value: 10,
                                                borderColor: 'rgb(255, 99, 132)',
                                                borderWidth: 2,
                                                label: {
                                                    enabled: true,
                                                    content: 'Test label'
                                                }

                                            },
                                            {
                                                type: 'line',
                                                mode: 'horizontal',
                                                scaleID: 'y-axis-0',
                                                value: 100,
                                                borderColor: 'rgb(255,0,0)',
                                                borderWidth: 2,
                                                label: {
                                                    enabled: true,
                                                    content: 'segundo'
                                                }

                                            }
                                        ]
                                    },
                                    scales: {
                                        yAxes: [
                                            {
                                                ticks: {
                                                    //fontFamily: "Roboto Mono",
                                                    //fontColor: "#556F7B",
                                                    //fontStyle: "bold",
                                                    beginAtZero: true,
                                                    //maxTicksLimit: 5,
                                                    //padding: 20
                                                },
                                                gridLines: {
                                                    //drawTicks: false,
                                                    //display: false,
                                                    //drawBorder: false
                                                }
                                            }
                                        ],
                                    }
                                }
                            });
                            break;
                        case 2:
                            userStrengthsChart = new Chart(ctx, {
                                type: 'radar',
                                data: datachart,
                                options: {
                                    title: {
                                        display: true,
                                        text: "Ergometría"
                                    },
                                    /*scale: {
                                        ticks: {
                                            beginAtZero: true,
                                        }
                                    }*/
                                }
                            });
                            break;

                    }
                },
                failure: function (response) {
                    alert('Ocurrió un error.');
                },

            });
        }

    </script>
</body>
</html>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//cdn.jsdelivr.net/excanvas/r3/excanvas.js" type="text/javascript"></script>
<script src="//cdn.jsdelivr.net/chart.js/0.2/Chart.js" type="text/javascript"></script>
<script src="~/Chart.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.5/chartjs-plugin-annotation.js"></script>
<script src="https://cdn.rawgit.com/chartjs/Chart.js/master/samples/utils.js"></script>